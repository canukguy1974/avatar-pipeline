"# InfiniteTalk Project: Agent.md Outline & Current State\n\n## Project Overview\n- InfiniteTalk is a real-time talking avatar system that streams AI-generated dialogue as continuous video.\n- Pipeline: LLM (OpenAI) → TTS (ElevenLabs) → Audio → InfiniteTalk binary → Video → HLS segments → Next.js frontend.\n- Prioritizes low-latency streaming, async/await throughout, and HLS segment windowing.\n\n## Key Components\n- FastAPI backend (src/app/main.py): Orchestrates sessions, WebSocket, HLS serving.\n- HLSWriter (src/app/hls_writer.py): Manages manifest, segment window, FFmpeg idle segmentation.\n- Next.js frontend (web/src/app/page.tsx): HLS.js video, WS events, UI controls.\n- FFmpeg: Used for MP4→HLS fMP4 segmenting, with sliding window and segment deletion.\n\n## Current State (Nov 17, 2025)\n- FFmpeg idle loop now correctly creates HLS segments in src/hls/ using relative paths and a finite loop/duration.\n- Backend launches FFmpeg at startup, ensures only one process, and serves HLS files via /hls/.\n- WebSocket and frontend are working; video plays idle loop as expected.\n- Port conflicts resolved by killing stale uvicorn/FFmpeg processes before backend start.\n- All paths unified to src/hls/ and .env is loaded from project root.\n- Next steps: further features (live video, TTS, LLM), or polish/monitoring as needed.\n\n## Flow Summary\n1. Backend starts, launches FFmpeg to create idle HLS segments.\n2. Frontend connects via WebSocket, waits for segments, attaches HLS.js.\n3. Video plays idle loop; ready for live segment injection.\n\n## Memory Purpose\n- This memory captures the current working state, architecture, and recent fixes (FFmpeg, port, path, and process management).\n- Use this as a baseline for future feature work, debugging, or onboarding.\n",